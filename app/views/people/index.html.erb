<%= link_to 'criar', new_person_path,class: 'btn btn-success' %>
<%= link_to 'ler arquivo xlsx','javascript:void(0)', class: 'btn btn-success',id: 'read_xls' %>
<%= file_field_tag 'file_xls', accept: 'xls,xlsx', style: 'display:none;' %>
<script type="text/javascript" charset="utf-8">
$(document).ready(function(){
    $('#read_xls').click(function(){
        $('#file_xls').click();    
    });

    $('#file_xls').change(function(){
        var ext = $(this).val().split('.')[1];
        if(ext != 'xls' && ext != 'xlsx'){
            alert('Arquivo de formato invalido, somente arquivos xls ou xlsx');
            $(this).val('');
        } else {
            var formData = new FormData();
            formData.append('file', $(this)[0].files[0]);
            $.ajax({
              type: 'POST',
              url: 'people/read_xls',
              dataType: 'json',
              processData : false,
              processData: false,  // tell jQuery not to process the data
              contentType: false,  // tell jQuery not to set contentType
              data: formData,
              success: function(data){
                  console.log(data);
                  alert('Foram inseridos '+data.count+' pessoas');
                    }
              }).done(function(data){
                console.log(data);
              });
        }
    });
});
</script>
<br />
<%= paginate @people %>
<table class='table table-hover'>
  <thead>
    <tr>
          <th>Data Cadastro</th>
          <th>Name</th>
          <th>Email</th>
          <th>Telefone</th>
          <th>Celular</th>
          <th>Vinculo</th>
          <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @people.each do |person| %>
      <tr>
        <td><%= to_date person.created_at %></td>
        <td><%= person.name %></td>
        <td><%= person.email %></td>
        <td><%= to_phone person.phone_number %></td>
        <td><%= to_phone person.cell_number %></td>
        <td><%= person.bond.name if person.bond.present? %></td>
        <td>
          <%= link_to 'detalhes', person,class: 'btn-sm btn-info' %>
          <%= link_to 'editar', edit_person_path(person),class: 'btn-sm btn-info' %>
          <%= link_to 'excluir', person, method: :delete, data: { confirm: 'Are you sure?' },class: 'btn-sm btn-info' %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= paginate @people %>

